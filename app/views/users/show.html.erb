<div id="profile-sidebar" class="sidebar">
	<%= image_tag @user.avatar.url(:medium), class: "avatar" %>
	<h1><%= @user.full_name %></h1>

	<div class="tips-counts">
		<span class="count"><%= @user.tips.count %></span>
		<p class="count-label">Tips</p>
	</div>

	<% if @user.friends.count == 0 && @user == current_user %>
		<div class="nofriends"><p>No friends yet. <a href="/contacts/gmail">Find some?</a><p></div>
	<% elsif @user.friends.count == 0 %>
		<div class="nofriends"><p>No friends yet.<br><% if @requested_friendship == nil %>You should fix that.<% end %><p></div>
	<% else %>
		<div class="friends-display">
			<% @user.friends.last(1).each do |friend| %>
		      <%= link_to profile_path(friend) do %> 
		      	<%= image_tag friend.avatar.url(:thumb) %>
		      <% end %>
		  <% end %>
			<div class="friends-count">
				<span class="count"><%= @user.friends.count %></span>
				<p class="count-label">Friend<% unless @user.friends.count == 1 %>s<% end %></p>
			</div>
			<% @user.friends.last(5).reverse.drop(1).each do |friend| %>
		      <%= link_to profile_path(friend) do %> 
		      	<%= image_tag friend.avatar.url(:thumb) %>
		      <% end %>
		  <% end %>
		</div>
	<% end %>

	<% if @user != current_user && @friendship == nil && @requested_friendship == nil %>
		<%= link_to "Add Friend", friendships_path(:friend_id => @user), class: "btn btn-primary", :method => :post %>
	<% elsif @user != current_user && @friendship == nil && @requested_friendship != nil %>
		<%= link_to "Friend Requested.", "#", class: "btn btn-default", :"disabled" => "disabled" %>
	<% end %>

	<% if @user != current_user && @friendship != nil %>
		<%= render '/tips/form' %>
	<% end %>

	<% if current_user == @user && @user.requested_friendships.last %>
		<h2>Friend Requests</h2>
		<ul>
			<% @user.requested_friendships.each do |request| %>
				<li>
		      <%= request.email %> 
		      <%= link_to "Accept", friendship_path(:id => request), :method => "put" %> 
		      <%= link_to "Decline", friendship_path(:id => request), :method => :delete %>
		    </li>
		  <% end %>
		</ul>
	<% end %>

	<div class="spacer"></div>
</div>

<div id="profile-content" class="js-isotope content" data-isotope-options='{ "layoutMode": "masonryHorizontal", "itemSelector": ".tip", "rowHeight": 240, "gutter": 10 }'>
	<% @tips.each do |tip| %>
		<div class="tip">
			<% unless tip.image_file_name.nil? %>
				<%= image_tag "tip-aro.png", class: "aro" %>
				<%= link_to image_tag(tip.image.url(:full)), tip.link %>
			<% end %>
			<div class="box">
		    <h3><%= link_to tip.title, tip.link %></h3>
		    <p><%= tip.description %></p>
		    <p>
		    	<span class="count"><%= tip.reshares %></span>
		    	<% if current_user == @user %>
		    		<%= link_to tip, method: :delete, data: { confirm: 'Are you sure?' } do %>
		    			<span class="glyphicon glyphicon-trash"></span>
		    		<% end %>
		    	<% end %>
	    	</p>
		  </div>
		</div>
	<% end %>
</div>